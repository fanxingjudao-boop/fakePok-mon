<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼RPG</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        body {
            overflow-x: hidden;
            touch-action: pan-y;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <!-- React and ReactDOM from CDN -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
        const MONSTER_DATABASE = {
          1: { id: 1, name: 'ãƒ’ãƒˆã‚«', type: 'fire', baseHP: 39, baseAtk: 52, baseDef: 43, evolvesTo: 2, evolveLevel: 16 },
          2: { id: 2, name: 'ãƒ’ã‚«ãƒªãƒ¥ã‚¦', type: 'fire', baseHP: 58, baseAtk: 64, baseDef: 58, evolvesTo: 3, evolveLevel: 36 },
          3: { id: 3, name: 'ãƒªã‚¶ãƒ¼ãƒ‰', type: 'fire', baseHP: 78, baseAtk: 84, baseDef: 78, evolvesTo: null, evolveLevel: null },
          4: { id: 4, name: 'ãƒŸã‚ºã‚¬ãƒ¡', type: 'water', baseHP: 44, baseAtk: 48, baseDef: 65, evolvesTo: 5, evolveLevel: 16 },
          5: { id: 5, name: 'ã‚«ãƒ¡ãƒƒã‚¯ã‚¹', type: 'water', baseHP: 59, baseAtk: 63, baseDef: 80, evolvesTo: 6, evolveLevel: 36 },
          6: { id: 6, name: 'ã‚«ãƒ¡ã‚­ãƒ³ã‚°', type: 'water', baseHP: 79, baseAtk: 83, baseDef: 100, evolvesTo: null, evolveLevel: null },
          7: { id: 7, name: 'ã‚¯ã‚µãƒ€ãƒ', type: 'grass', baseHP: 45, baseAtk: 49, baseDef: 49, evolvesTo: 8, evolveLevel: 16 },
          8: { id: 8, name: 'ã‚¯ã‚µãƒãƒŠ', type: 'grass', baseHP: 60, baseAtk: 62, baseDef: 63, evolvesTo: 9, evolveLevel: 36 },
          9: { id: 9, name: 'ã‚¯ã‚µã‚ªãƒ¼', type: 'grass', baseHP: 80, baseAtk: 82, baseDef: 83, evolvesTo: null, evolveLevel: null }
        };

        // æŠ€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
        const MOVES_DATABASE = {
          fire: [
            { name: 'ã²ã£ã‹ã', power: 40, type: 'normal', level: 1 },
            { name: 'ã²ã®ã“', power: 40, type: 'fire', level: 1 },
            { name: 'ãã‚Šã•ã', power: 70, type: 'normal', level: 20 },
            { name: 'ã‹ãˆã‚“ã»ã†ã—ã‚ƒ', power: 95, type: 'fire', level: 30 }
          ],
          water: [
            { name: 'ãŸã„ã‚ãŸã‚Š', power: 40, type: 'normal', level: 1 },
            { name: 'ã¿ãšã§ã£ã½ã†', power: 40, type: 'water', level: 1 },
            { name: 'ã‹ã¿ã¤ã', power: 60, type: 'normal', level: 20 },
            { name: 'ãƒã‚¤ãƒ‰ãƒ­ãƒãƒ³ãƒ—', power: 110, type: 'water', level: 30 }
          ],
          grass: [
            { name: 'ãŸã„ã‚ãŸã‚Š', power: 40, type: 'normal', level: 1 },
            { name: 'ã¤ã‚‹ã®ãƒ ãƒ', power: 45, type: 'grass', level: 1 },
            { name: 'ã¯ã£ã±ã‚«ãƒƒã‚¿ãƒ¼', power: 55, type: 'grass', level: 20 },
            { name: 'ã‚½ãƒ¼ãƒ©ãƒ¼ãƒ“ãƒ¼ãƒ ', power: 120, type: 'grass', level: 30 }
          ]
        };

        // ã‚¿ã‚¤ãƒ—ç›¸æ€§
        const TYPE_CHART = {
          fire: { grass: 2, water: 0.5, fire: 1, normal: 1 },
          water: { fire: 2, grass: 0.5, water: 1, normal: 1 },
          grass: { water: 2, fire: 0.5, grass: 1, normal: 1 },
          normal: { fire: 1, water: 1, grass: 1, normal: 1 }
        };

        const PokemonRPG = () => {
          const [screen, setScreen] = useState('title');
          const [playerMonster, setPlayerMonster] = useState(null);
          const [enemyMonster, setEnemyMonster] = useState(null);
          const [battleLog, setBattleLog] = useState([]);
          const [isPlayerTurn, setIsPlayerTurn] = useState(true);
          const [battlesWon, setBattlesWon] = useState(0);
          const [isAnimating, setIsAnimating] = useState(false);
          const [damageFlash, setDamageFlash] = useState(null);
          const [showEvolution, setShowEvolution] = useState(false);
          const [evolutionData, setEvolutionData] = useState(null);

          useEffect(() => {
            const saved = localStorage.getItem('pokemonRPGSave');
            if (saved) {
              const data = JSON.parse(saved);
              if (data.playerMonster) {
                setPlayerMonster(data.playerMonster);
                setBattlesWon(data.battlesWon || 0);
                setScreen('main');
              }
            }
          }, []);

          const saveGame = (monster, wins) => {
            localStorage.setItem('pokemonRPGSave', JSON.stringify({
              playerMonster: monster,
              battlesWon: wins
            }));
          };

          const createMonster = (monsterId, level = 1) => {
            const baseData = MONSTER_DATABASE[monsterId];
            const hpBonus = (level - 1) * 5;
            const atkBonus = (level - 1) * 3;
            const defBonus = (level - 1) * 3;
            
            const maxHP = baseData.baseHP + hpBonus;
            const moves = MOVES_DATABASE[baseData.type].filter(m => m.level <= level);
            
            return {
              ...baseData,
              level,
              exp: 0,
              expToNext: level * 100,
              currentHP: maxHP,
              maxHP,
              attack: baseData.baseAtk + atkBonus,
              defense: baseData.baseDef + defBonus,
              moves: moves.slice(-4)
            };
          };

          const selectStarter = (monsterId) => {
            const monster = createMonster(monsterId, 5);
            setPlayerMonster(monster);
            saveGame(monster, 0);
            setScreen('main');
          };

          const startBattle = () => {
            const playerLevel = playerMonster.level;
            const enemyLevel = Math.max(1, playerLevel + Math.floor(Math.random() * 5) - 2);
            const enemyTypes = ['fire', 'water', 'grass'];
            const randomType = enemyTypes[Math.floor(Math.random() * 3)];
            
            let enemyId;
            if (randomType === 'fire') enemyId = enemyLevel >= 36 ? 3 : enemyLevel >= 16 ? 2 : 1;
            else if (randomType === 'water') enemyId = enemyLevel >= 36 ? 6 : enemyLevel >= 16 ? 5 : 4;
            else enemyId = enemyLevel >= 36 ? 9 : enemyLevel >= 16 ? 8 : 7;
            
            const enemy = createMonster(enemyId, enemyLevel);
            setEnemyMonster(enemy);
            setBattleLog([`é‡ç”Ÿã®${enemy.name}ãŒç¾ã‚ŒãŸï¼`]);
            setIsPlayerTurn(true);
            setScreen('battle');
          };

          const calculateDamage = (attacker, defender, move) => {
            const effectiveness = TYPE_CHART[move.type][defender.type];
            const baseDamage = ((attacker.attack * move.power / defender.defense) / 10) * effectiveness;
            const damage = Math.max(1, Math.floor(baseDamage));
            return { damage, effectiveness };
          };

          const playerAttack = (move) => {
            if (isAnimating || !isPlayerTurn) return;
            
            setIsAnimating(true);
            const { damage, effectiveness } = calculateDamage(playerMonster, enemyMonster, move);
            
            const newEnemyHP = Math.max(0, enemyMonster.currentHP - damage);
            setEnemyMonster({ ...enemyMonster, currentHP: newEnemyHP });
            setDamageFlash('enemy');
            
            let effectText = '';
            if (effectiveness === 2) effectText = 'åŠ¹æœã¯æŠœç¾¤ã ï¼';
            else if (effectiveness === 0.5) effectText = 'åŠ¹æœã¯ã„ã¾ã²ã¨ã¤ã ...';
            
            setBattleLog(prev => [...prev, `${playerMonster.name}ã®${move.name}ï¼`, effectText].filter(Boolean));
            
            setTimeout(() => {
              setDamageFlash(null);
              if (newEnemyHP === 0) {
                setTimeout(() => {
                  const expGained = enemyMonster.level * 50;
                  const newExp = playerMonster.exp + expGained;
                  
                  setBattleLog(prev => [...prev, `${enemyMonster.name}ã‚’å€’ã—ãŸï¼`, `${expGained}ã®çµŒé¨“å€¤ã‚’å¾—ãŸï¼`]);
                  
                  if (newExp >= playerMonster.expToNext) {
                    levelUp(expGained);
                  } else {
                    const updatedMonster = { ...playerMonster, exp: newExp };
                    setPlayerMonster(updatedMonster);
                    const newWins = battlesWon + 1;
                    setBattlesWon(newWins);
                    saveGame(updatedMonster, newWins);
                    
                    setTimeout(() => {
                      setScreen('main');
                      setIsAnimating(false);
                    }, 2000);
                  }
                }, 1000);
              } else {
                setIsPlayerTurn(false);
                setTimeout(() => enemyAttack(), 1500);
              }
            }, 500);
          };

          const enemyAttack = () => {
            const move = enemyMonster.moves[Math.floor(Math.random() * enemyMonster.moves.length)];
            const { damage } = calculateDamage(enemyMonster, playerMonster, move);
            
            const newPlayerHP = Math.max(0, playerMonster.currentHP - damage);
            setPlayerMonster({ ...playerMonster, currentHP: newPlayerHP });
            setDamageFlash('player');
            
            setBattleLog(prev => [...prev, `${enemyMonster.name}ã®${move.name}ï¼`]);
            
            setTimeout(() => {
              setDamageFlash(null);
              if (newPlayerHP === 0) {
                setBattleLog(prev => [...prev, `${playerMonster.name}ã¯å€’ã‚ŒãŸ...`]);
                setTimeout(() => {
                  setScreen('gameover');
                  setIsAnimating(false);
                }, 2000);
              } else {
                setIsPlayerTurn(true);
                setIsAnimating(false);
              }
            }, 500);
          };

          const levelUp = (expGained) => {
            const newLevel = playerMonster.level + 1;
            const newMaxHP = playerMonster.maxHP + 5;
            const newAttack = playerMonster.attack + 3;
            const newDefense = playerMonster.defense + 3;
            const newExpToNext = newLevel * 100;
            const remainingExp = (playerMonster.exp + expGained) - playerMonster.expToNext;
            
            const newMoves = MOVES_DATABASE[playerMonster.type].filter(m => m.level <= newLevel).slice(-4);
            
            let updatedMonster = {
              ...playerMonster,
              level: newLevel,
              exp: remainingExp,
              expToNext: newExpToNext,
              currentHP: playerMonster.currentHP + 5,
              maxHP: newMaxHP,
              attack: newAttack,
              defense: newDefense,
              moves: newMoves
            };
            
            setBattleLog(prev => [...prev, `${playerMonster.name}ã¯ãƒ¬ãƒ™ãƒ«${newLevel}ã«ãªã£ãŸï¼`]);
            
            if (playerMonster.evolvesTo && newLevel >= playerMonster.evolveLevel) {
              setTimeout(() => {
                evolveMonster(updatedMonster);
              }, 2000);
            } else {
              setPlayerMonster(updatedMonster);
              const newWins = battlesWon + 1;
              setBattlesWon(newWins);
              saveGame(updatedMonster, newWins);
              
              setTimeout(() => {
                setScreen('main');
                setIsAnimating(false);
              }, 2000);
            }
          };

          const evolveMonster = (monster) => {
            const evolvedData = MONSTER_DATABASE[monster.evolvesTo];
            setEvolutionData({ from: monster.name, to: evolvedData.name });
            setShowEvolution(true);
            
            setTimeout(() => {
              const hpBonus = (monster.level - 1) * 5;
              const atkBonus = (monster.level - 1) * 3;
              const defBonus = (monster.level - 1) * 3;
              
              const hpIncrease = (evolvedData.baseHP - MONSTER_DATABASE[monster.id].baseHP);
              const atkIncrease = (evolvedData.baseAtk - MONSTER_DATABASE[monster.id].baseAtk);
              const defIncrease = (evolvedData.baseDef - MONSTER_DATABASE[monster.id].baseDef);
              
              const evolvedMonster = {
                ...monster,
                ...evolvedData,
                maxHP: evolvedData.baseHP + hpBonus,
                currentHP: monster.currentHP + hpIncrease,
                attack: evolvedData.baseAtk + atkBonus,
                defense: evolvedData.baseDef + defBonus
              };
              
              setPlayerMonster(evolvedMonster);
              const newWins = battlesWon + 1;
              setBattlesWon(newWins);
              saveGame(evolvedMonster, newWins);
              
              setTimeout(() => {
                setShowEvolution(false);
                setScreen('main');
                setIsAnimating(false);
              }, 3000);
            }, 2000);
          };

          const healMonster = () => {
            const healed = { ...playerMonster, currentHP: playerMonster.maxHP };
            setPlayerMonster(healed);
            saveGame(healed, battlesWon);
          };

          const resetGame = () => {
            localStorage.removeItem('pokemonRPGSave');
            setPlayerMonster(null);
            setEnemyMonster(null);
            setBattlesWon(0);
            setScreen('title');
          };

          const getHPBarColor = (current, max) => {
            const percentage = (current / max) * 100;
            if (percentage > 50) return '#48D248';
            if (percentage > 25) return '#F8D030';
            return '#F85030';
          };

          const getTypeColor = (type) => {
            const colors = {
              fire: '#F08030',
              water: '#6890F0',
              grass: '#78C850',
              normal: '#A8A878'
            };
            return colors[type];
          };

          if (screen === 'title') {
            return (
              <div style={{ 
                minHeight: '100vh', 
                background: 'linear-gradient(to bottom, #87CEEB, #E8F4F8)',
                display: 'flex',
                alignItems: 'center',
                justifyContent: 'center',
                fontFamily: 'monospace',
                padding: '20px'
              }}>
                <div style={{ 
                  background: 'white', 
                  border: '4px solid #333',
                  borderRadius: '10px',
                  padding: '40px',
                  textAlign: 'center',
                  maxWidth: '500px'
                }}>
                  <h1 style={{ fontSize: '36px', margin: '0 0 20px 0', color: '#333' }}>
                    âš¡ ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼RPG âš¡
                  </h1>
                  <p style={{ fontSize: '16px', marginBottom: '30px', color: '#666' }}>
                    åˆä»£ãƒã‚±ãƒ¢ãƒ³é¢¨ã®è‚²æˆãƒãƒˆãƒ«ã‚²ãƒ¼ãƒ 
                  </p>
                  <button
                    onClick={() => setScreen('select')}
                    style={{
                      background: '#4A90E2',
                      color: 'white',
                      border: 'none',
                      padding: '15px 40px',
                      fontSize: '18px',
                      borderRadius: '5px',
                      cursor: 'pointer',
                      fontFamily: 'monospace',
                      fontWeight: 'bold'
                    }}
                  >
                    ã¯ã˜ã‚ã‚‹
                  </button>
                </div>
              </div>
            );
          }

          if (screen === 'select') {
            return (
              <div style={{ 
                minHeight: '100vh', 
                background: 'linear-gradient(to bottom, #87CEEB, #E8F4F8)',
                padding: '20px',
                fontFamily: 'monospace'
              }}>
                <div style={{ maxWidth: '800px', margin: '0 auto' }}>
                  <h2 style={{ textAlign: 'center', fontSize: '24px', marginBottom: '30px' }}>
                    æœ€åˆã®ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸ã‚“ã§ãã ã•ã„
                  </h2>
                  <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '20px' }}>
                    {[1, 4, 7].map(id => {
                      const monster = MONSTER_DATABASE[id];
                      return (
                        <div
                          key={id}
                          onClick={() => selectStarter(id)}
                          style={{
                            background: 'white',
                            border: '3px solid #333',
                            borderRadius: '10px',
                            padding: '20px',
                            cursor: 'pointer',
                            textAlign: 'center'
                          }}
                        >
                          <div style={{
                            width: '100px',
                            height: '100px',
                            margin: '0 auto 15px',
                            background: getTypeColor(monster.type),
                            borderRadius: '50%',
                            display: 'flex',
                            alignItems: 'center',
                            justifyContent: 'center',
                            fontSize: '48px'
                          }}>
                            {monster.type === 'fire' ? 'ğŸ”¥' : monster.type === 'water' ? 'ğŸ’§' : 'ğŸŒ¿'}
                          </div>
                          <h3 style={{ margin: '10px 0', fontSize: '20px' }}>{monster.name}</h3>
                          <p style={{ margin: '5px 0', color: '#666', fontSize: '14px' }}>
                            ã‚¿ã‚¤ãƒ—: {monster.type === 'fire' ? 'ç‚' : monster.type === 'water' ? 'æ°´' : 'è‰'}
                          </p>
                          <p style={{ margin: '5px 0', fontSize: '12px' }}>HP: {monster.baseHP} / æ”»æ’ƒ: {monster.baseAtk} / é˜²å¾¡: {monster.baseDef}</p>
                        </div>
                      );
                    })}
                  </div>
                </div>
              </div>
            );
          }

          if (screen === 'main') {
            return (
              <div style={{ 
                minHeight: '100vh', 
                background: 'linear-gradient(to bottom, #87CEEB, #E8F4F8)',
                padding: '20px',
                fontFamily: 'monospace'
              }}>
                <div style={{ maxWidth: '600px', margin: '0 auto' }}>
                  <div style={{ 
                    background: 'white', 
                    border: '3px solid #333',
                    borderRadius: '10px',
                    padding: '30px',
                    marginBottom: '20px'
                  }}>
                    <h2 style={{ textAlign: 'center', marginBottom: '20px' }}>ã‚ãªãŸã®ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼</h2>
                    <div style={{ display: 'flex', alignItems: 'center', gap: '20px' }}>
                      <div style={{
                        width: '120px',
                        height: '120px',
                        background: getTypeColor(playerMonster.type),
                        borderRadius: '50%',
                        display: 'flex',
                        alignItems: 'center',
                        justifyContent: 'center',
                        fontSize: '64px',
                        flexShrink: 0
                      }}>
                        {playerMonster.type === 'fire' ? 'ğŸ”¥' : playerMonster.type === 'water' ? 'ğŸ’§' : 'ğŸŒ¿'}
                      </div>
                      <div style={{ flex: 1 }}>
                        <h3 style={{ margin: '0 0 10px 0', fontSize: '24px' }}>{playerMonster.name} Lv.{playerMonster.level}</h3>
                        <div style={{ marginBottom: '8px' }}>
                          <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '5px' }}>
                            <span>HP:</span>
                            <span>{playerMonster.currentHP} / {playerMonster.maxHP}</span>
                          </div>
                          <div style={{ 
                            width: '100%', 
                            height: '20px', 
                            background: '#ddd', 
                            borderRadius: '10px',
                            overflow: 'hidden'
                          }}>
                            <div style={{ 
                              width: `${(playerMonster.currentHP / playerMonster.maxHP) * 100}%`,
                              height: '100%',
                              background: getHPBarColor(playerMonster.currentHP, playerMonster.maxHP),
                              transition: 'width 0.3s'
                            }} />
                          </div>
                        </div>
                        <div style={{ marginBottom: '8px' }}>
                          <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '5px' }}>
                            <span>EXP:</span>
                            <span>{playerMonster.exp} / {playerMonster.expToNext}</span>
                          </div>
                          <div style={{ 
                            width: '100%', 
                            height: '12px', 
                            background: '#ddd', 
                            borderRadius: '6px',
                            overflow: 'hidden'
                          }}>
                            <div style={{ 
                              width: `${(playerMonster.exp / playerMonster.expToNext) * 100}%`,
                              height: '100%',
                              background: '#4A90E2',
                              transition: 'width 0.3s'
                            }} />
                          </div>
                        </div>
                        <p style={{ margin: '5px 0', fontSize: '14px' }}>
                          æ”»æ’ƒ: {playerMonster.attack} / é˜²å¾¡: {playerMonster.defense}
                        </p>
                      </div>
                    </div>
                    <div style={{ marginTop: '20px' }}>
                      <h4 style={{ marginBottom: '10px' }}>ç¿’å¾—ã—ã¦ã„ã‚‹æŠ€:</h4>
                      <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '10px' }}>
                        {playerMonster.moves.map((move, idx) => (
                          <div key={idx} style={{
                            padding: '10px',
                            background: '#f0f0f0',
                            borderRadius: '5px',
                            border: '2px solid #999'
                          }}>
                            <div style={{ fontWeight: 'bold' }}>{move.name}</div>
                            <div style={{ fontSize: '12px', color: '#666' }}>å¨åŠ›: {move.power}</div>
                          </div>
                        ))}
                      </div>
                    </div>
                  </div>

                  <div style={{
                    background: 'white',
                    border: '3px solid #333',
                    borderRadius: '10px',
                    padding: '20px',
                    marginBottom: '20px',
                    textAlign: 'center'
                  }}>
                    <p style={{ fontSize: '18px', marginBottom: '10px' }}>
                      ğŸ† å‹åˆ©æ•°: {battlesWon}
                    </p>
                  </div>

                  <div style={{ display: 'flex', gap: '10px' }}>
                    <button
                      onClick={startBattle}
                      style={{
                        flex: 1,
                        background: '#48D248',
                        color: 'white',
                        border: 'none',
                        padding: '15px',
                        fontSize: '18px',
                        borderRadius: '5px',
                        cursor: 'pointer',
                        fontFamily: 'monospace',
                        fontWeight: 'bold'
                      }}
                    >
                      ãƒãƒˆãƒ«é–‹å§‹
                    </button>
                    <button
                      onClick={healMonster}
                      disabled={playerMonster.currentHP === playerMonster.maxHP}
                      style={{
                        flex: 1,
                        background: playerMonster.currentHP === playerMonster.maxHP ? '#ccc' : '#F8D030',
                        color: playerMonster.currentHP === playerMonster.maxHP ? '#999' : 'white',
                        border: 'none',
                        padding: '15px',
                        fontSize: '18px',
                        borderRadius: '5px',
                        cursor: playerMonster.currentHP === playerMonster.maxHP ? 'not-allowed' : 'pointer',
                        fontFamily: 'monospace',
                        fontWeight: 'bold'
                      }}
                    >
                      å›å¾©
                    </button>
                  </div>

                  <button
                    onClick={resetGame}
                    style={{
                      width: '100%',
                      marginTop: '10px',
                      background: '#999',
                      color: 'white',
                      border: 'none',
                      padding: '10px',
                      fontSize: '14px',
                      borderRadius: '5px',
                      cursor: 'pointer',
                      fontFamily: 'monospace'
                    }}
                  >
                    ã‚²ãƒ¼ãƒ ã‚’ãƒªã‚»ãƒƒãƒˆ
                  </button>
                </div>
              </div>
            );
          }

          if (screen === 'battle') {
            return (
              <div style={{ 
                minHeight: '100vh', 
                background: 'linear-gradient(to bottom, #87CEEB, #E8F4F8)',
                padding: '20px',
                fontFamily: 'monospace'
              }}>
                <div style={{ maxWidth: '800px', margin: '0 auto' }}>
                  <div style={{ 
                    display: 'flex', 
                    justifyContent: 'flex-end',
                    marginBottom: '40px',
                    paddingRight: '50px'
                  }}>
                    <div>
                      <div style={{
                        background: 'white',
                        border: '3px solid #333',
                        borderRadius: '10px',
                        padding: '15px',
                        marginBottom: '15px',
                        minWidth: '250px'
                      }}>
                        <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '8px' }}>
                          <span style={{ fontWeight: 'bold', fontSize: '18px' }}>{enemyMonster.name}</span>
                          <span>Lv.{enemyMonster.level}</span>
                        </div>
                        <div style={{ marginBottom: '5px', display: 'flex', justifyContent: 'space-between', fontSize: '14px' }}>
                          <span>HP:</span>
                          <span>{enemyMonster.currentHP} / {enemyMonster.maxHP}</span>
                        </div>
                        <div style={{ 
                          width: '100%', 
                          height: '20px', 
                          background: '#ddd', 
                          borderRadius: '10px',
                          overflow: 'hidden'
                        }}>
                          <div style={{ 
                            width: `${(enemyMonster.currentHP / enemyMonster.maxHP) * 100}%`,
                            height: '100%',
                            background: getHPBarColor(enemyMonster.currentHP, enemyMonster.maxHP),
                            transition: 'width 0.3s'
                          }} />
                        </div>
                      </div>
                      <div style={{
                        width: '150px',
                        height: '150px',
                        background: damageFlash === 'enemy' ? '#ff000080' : getTypeColor(enemyMonster.type),
                        borderRadius: '50%',
                        display: 'flex',
                        alignItems: 'center',
                        justifyContent: 'center',
                        fontSize: '80px',
                        transition: 'background 0.3s',
                        margin: '0 auto'
                      }}>
                        {enemyMonster.type === 'fire' ? 'ğŸ”¥' : enemyMonster.type === 'water' ? 'ğŸ’§' : 'ğŸŒ¿'}
                      </div>
                    </div>
                  </div>

                  <div style={{ 
                    display: 'flex', 
                    justifyContent: 'flex-start',
                    marginBottom: '30px',
                    paddingLeft: '50px'
                  }}>
                    <div>
                      <div style={{
                        width: '150px',
                        height: '150px',
                        background: damageFlash === 'player' ? '#ff000080' : getTypeColor(playerMonster.type),
                        borderRadius: '50%',
                        display: 'flex',
                        alignItems: 'center',
                        justifyContent: 'center',
                        fontSize: '80px',
                        transition: 'background 0.3s',
                        margin: '0 auto 15px'
                      }}>
                        {playerMonster.type === 'fire' ? 'ğŸ”¥' : playerMonster.type === 'water' ? 'ğŸ’§' : 'ğŸŒ¿'}
                      </div>
                      <div style={{
                        background: 'white',
                        border: '3px solid #333',
                        borderRadius: '10px',
                        padding: '15px',
                        minWidth: '250px'
                      }}>
                        <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '8px' }}>
                          <span style={{ fontWeight: 'bold', fontSize: '18px' }}>{playerMonster.name}</span>
                          <span>Lv.{playerMonster.level}</span>
                        </div>
                        <div style={{ marginBottom: '5px', display: 'flex', justifyContent: 'space-between', fontSize: '14px' }}>
                          <span>HP:</span>
                          <span>{playerMonster.currentHP} / {playerMonster.maxHP}</span>
                        </div>
                        <div style={{ 
                          width: '100%', 
                          height: '20px', 
                          background: '#ddd', 
                          borderRadius: '10px',
                          overflow: 'hidden',
                          marginBottom: '8px'
                        }}>
                          <div style={{ 
                            width: `${(playerMonster.currentHP / playerMonster.maxHP) * 100}%`,
                            height: '100%',
                            background: getHPBarColor(playerMonster.currentHP, playerMonster.maxHP),
                            transition: 'width 0.3s'
                          }} />
                        </div>
                        <div style={{ marginBottom: '5px', display: 'flex', justifyContent: 'space-between', fontSize: '12px' }}>
                          <span>EXP:</span>
                          <span>{playerMonster.exp} / {playerMonster.expToNext}</span>
                        </div>
                        <div style={{ 
                          width: '100%', 
                          height: '12px', 
                          background: '#ddd', 
                          borderRadius: '6px',
                          overflow: 'hidden'
                        }}>
                          <div style={{ 
                            width: `${(playerMonster.exp / playerMonster.expToNext) * 100}%`,
                            height: '100%',
                            background: '#4A90E2',
                            transition: 'width 0.3s'
                          }} />
                        </div>
                      </div>
                    </div>
                  </div>

                  <div style={{
                    background: 'white',
                    border: '3px solid #333',
                    borderRadius: '10px',
                    padding: '20px',
                    marginBottom: '20px',
                    minHeight: '100px',
                    maxHeight: '120px',
                    overflowY: 'auto'
                  }}>
                    {battleLog.map((log, idx) => (
                      <p key={idx} style={{ margin: '5px 0', fontSize: '16px' }}>{log}</p>
                    ))}
                  </div>

                  <div style={{
                    display: 'grid',
                    gridTemplateColumns: '1fr 1fr',
                    gap: '15px'
                  }}>
                    {playerMonster.moves.map((move, idx) => (
                      <button
                        key={idx}
                        onClick={() => playerAttack(move)}
                        disabled={!isPlayerTurn || isAnimating}
                        style={{
                          background: !isPlayerTurn || isAnimating ? '#ccc' : '#4A90E2',
                          color: 'white',
                          border: '3px solid #333',
                          padding: '20px',
                          fontSize: '16px',
                          borderRadius: '10px',
                          cursor: !isPlayerTurn || isAnimating ? 'not-allowed' : 'pointer',
                          fontFamily: 'monospace',
                          fontWeight: 'bold',
                          textAlign: 'left'
                        }}
                      >
                        <div style={{ fontSize: '18px', marginBottom: '5px' }}>{move.name}</div>
                        <div style={{ fontSize: '14px', opacity: 0.8 }}>
                          å¨åŠ›: {move.power} / ã‚¿ã‚¤ãƒ—: {move.type === 'fire' ? 'ç‚' : move.type === 'water' ? 'æ°´' : move.type === 'grass' ? 'è‰' : 'ãƒãƒ¼ãƒãƒ«'}
                        </div>
                      </button>
                    ))}
                  </div>
                </div>
              </div>
            );
          }

          if (showEvolution) {
            return (
              <div style={{ 
                minHeight: '100vh', 
                background: 'linear-gradient(to bottom, #1a1a2e, #16213e)',
                display: 'flex',
                alignItems: 'center',
                justifyContent: 'center',
                fontFamily: 'monospace',
                color: 'white'
              }}>
                <div style={{ textAlign: 'center' }}>
                  <h1 style={{ fontSize: '36px', marginBottom: '30px' }}>
                    âœ¨ é€²åŒ–ä¸­... âœ¨
                  </h1>
                  <p style={{ fontSize: '24px' }}>
                    {evolutionData.from} â†’ {evolutionData.to}
                  </p>
                </div>
              </div>
            );
          }

          if (screen === 'gameover') {
            return (
              <div style={{ 
                minHeight: '100vh', 
                background: 'linear-gradient(to bottom, #2c2c2c, #1a1a1a)',
                display: 'flex',
                alignItems: 'center',
                justifyContent: 'center',
                fontFamily: 'monospace',
                padding: '20px'
              }}>
                <div style={{ 
                  background: 'white', 
                  border: '4px solid #333',
                  borderRadius: '10px',
                  padding: '40px',
                  textAlign: 'center',
                  maxWidth: '500px'
                }}>
                  <h1 style={{ fontSize: '36px', margin: '0 0 20px 0', color: '#F85030' }}>
                    GAME OVER
                  </h1>
                  <p style={{ fontSize: '18px', marginBottom: '10px' }}>
                    {playerMonster.name}ã¯åŠ›å°½ããŸ...
                  </p>
                  <p style={{ fontSize: '16px', marginBottom: '30px', color: '#666' }}>
                    å‹åˆ©æ•°: {battlesWon}
                  </p>
                  <button
                    onClick={resetGame}
                    style={{
                      background: '#4A90E2',
                      color: 'white',
                      border: 'none',
                      padding: '15px 40px',
                      fontSize: '18px',
                      borderRadius: '5px',
                      cursor: 'pointer',
                      fontFamily: 'monospace',
                      fontWeight: 'bold'
                    }}
                  >
                    æœ€åˆã‹ã‚‰
                  </button>
                </div>
              </div>
            );
          }

          return null;
        };

        ReactDOM.render(<PokemonRPG />, document.getElementById('root'));
    </script>
</body>
</html>
